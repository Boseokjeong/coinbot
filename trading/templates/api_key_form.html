{% extends 'base.html' %}

{% block extrahead %}
<!-- Include Bootstrap CSS from CDN -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
<!-- Include FontAwesome for the eye icon -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css">
{% endblock %}

{% block content %}
<div class="container mt-5">
  <div class="row">
    <div class="col-md-6 offset-md-3">
      <div class="card">
        <div class="card-header">
          <h2 class="text-center">업비트 API 키 설정</h2>
        </div>
        <div class="card-body">
          <form method="post" id="apiForm">
            {% csrf_token %}
            <div class="form-group">
              <label for="id_upbit_api_key">{{ form.upbit_api_key.label }}</label>
              <div class="input-group" id="show_hide_password_api_key">
                {{ form.upbit_api_key }}
                <div class="input-group-append">
                  <button class="btn btn-outline-secondary" type="button" onclick="toggleVisibility('id_upbit_api_key', this)">
                    <i class="fas fa-eye-slash"></i>
                  </button>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label for="id_upbit_secret_key">{{ form.upbit_secret_key.label }}</label>
              <div class="input-group" id="show_hide_password_secret_key">
                {{ form.upbit_secret_key }}
                <div class="input-group-append">
                  <button class="btn btn-outline-secondary" type="button" onclick="toggleVisibility('id_upbit_secret_key', this)">
                    <i class="fas fa-eye-slash"></i>
                  </button>
                </div>
              </div>
            </div>
            <button type="submit" class="btn btn-primary btn-block">저장</button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Include Bootstrap Bundle with Popper and jQuery -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/js/all.min.js"></script>

<script>
  // 페이지 로드 시 입력 필드를 password 유형으로 설정합니다.
  window.onload = function() {
    var apiKeyInput = document.getElementById('id_upbit_api_key');
    var secretKeyInput = document.getElementById('id_upbit_secret_key');
    if (apiKeyInput && secretKeyInput) {
      apiKeyInput.type = 'password';
      secretKeyInput.type = 'password';
    }
  }

  // 보기/숨기기 버튼의 기능을 설정합니다.
  function toggleVisibility(fieldId, toggleButton) {
    var inputField = document.getElementById(fieldId);
    var icon = toggleButton.querySelector('i');
    if (inputField.type === 'password') {
      inputField.type = 'text';
      icon.classList.remove('fa-eye-slash');
      icon.classList.add('fa-eye');
    } else {
      inputField.type = 'password';
      icon.classList.remove('fa-eye');
      icon.classList.add('fa-eye-slash');
    }
  }
</script>
{% endblock %}
